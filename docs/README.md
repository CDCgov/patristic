<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [version][1]
    -   [Examples][2]
-   [Branch][3]
    -   [Parameters][4]
    -   [addChild][5]
        -   [Parameters][6]
    -   [addParent][7]
        -   [Parameters][8]
    -   [clone][9]
    -   [depthOf][10]
        -   [Parameters][11]
    -   [distanceTo][12]
        -   [Parameters][13]
    -   [excise][14]
    -   [fixParenthood][15]
        -   [Parameters][16]
    -   [getAncestors][17]
    -   [getChild][18]
        -   [Parameters][19]
    -   [getDescendant][20]
        -   [Parameters][21]
    -   [getDescendants][22]
        -   [Parameters][23]
    -   [getLeafs][24]
    -   [getLeaves][25]
    -   [getMRCA][26]
        -   [Parameters][27]
    -   [getRoot][28]
    -   [hasChild][29]
        -   [Parameters][30]
    -   [hasDescendant][31]
        -   [Parameters][32]
    -   [hasLeaf][33]
        -   [Parameters][34]
    -   [invert][35]
    -   [isChildOf][36]
        -   [Parameters][37]
    -   [isConsistent][38]
    -   [isDescendantOf][39]
        -   [Parameters][40]
    -   [isLeaf][41]
    -   [isolate][42]
    -   [isRoot][43]
    -   [remove][44]
    -   [reroot][45]
        -   [Examples][46]
    -   [setLength][47]
        -   [Parameters][48]
    -   [setParent][49]
        -   [Parameters][50]
    -   [sources][51]
        -   [Parameters][52]
    -   [targets][53]
        -   [Parameters][54]
    -   [toJSON][55]
    -   [toMatrix][56]
    -   [toNewick][57]
        -   [Parameters][58]
    -   [toObject][59]
-   [parseJSON][60]
    -   [Parameters][61]
-   [parseMatrix][62]
    -   [Parameters][63]
-   [parseNewick][64]
    -   [Parameters][65]

## version

The SemVer version string of the patristic library

Type: [String][66]

### Examples

```javascript
console.log(patristic.version);
```

## Branch

A class for representing branches in trees.
It's written predominantly for phylogenetic trees (hence the
[Newick parser][67],
[neighbor-joining implementation][68], etc.), but could
conceivably be useful for representing other types of trees as well.

### Parameters

-   `data` **[Object][69]** An object containing data you wish to assign to
    this Branch object. In particular, intended to overwrite the default
    attributes of a Branch, namely `id`, `parent`, `length`, and `children`.

### addChild

Adds a new child to this Branch

#### Parameters

-   `data` **([Branch][70] \| [Object][69])** [description]

Returns **[Branch][70]** The (possibly new) child Branch

### addParent

Adds a new parent to this Branch. This is a bit esoteric and generally not
recommended.

#### Parameters

-   `data` **([Branch][70] \| [Object][69])** A Branch object, or the data to attach to one
-   `siblings` **[Array][71]** An array of Branches to be the children of the new parent branch (i.e. siblings of this Branch)

Returns **[Branch][70]** The Branch on which this was called

### clone

Returns a clone of the Branch on which it is called. Note that this also
clones all descendants, rather than providing references to the existing
descendant Branches.

Returns **[Branch][70]** A clone of the Branch on which it is called.

### depthOf

Returns the depth of a given child, relative to the node on which it is
called.

#### Parameters

-   `descendant` **([Branch][70] \| [String][66])** A descendant Branch (or `id` string thereof)

Returns **[Number][72]** The sum of the all branches between the Branch on which it
is called and child. Return an error if `descendant` is not a descendant of
this Branch.

### distanceTo

Computes the patristic distance between `cousin` and the Branch on which
this method is called.

#### Parameters

-   `cousin` **[Branch][70]** The Branch to which you wish to compute distance

Returns **[number][72]** The patristic distance between `cousin` and the branch on
this method is called.

### excise

Excises the Branch on which it is called and updates its parent and children

Returns **[Branch][70]** The parent of the excised Branch.

### fixParenthood

Repairs incorrect links by recurively confirming that children reference
their parents, and correcting those references if they do not.
If you need to call this, something has messed up the state of your tree
and you should be concerned about that. Just FYI. ¯\_(ツ)\_/¯

#### Parameters

-   `nonrecursive` **[Boolean][73]** Should this just fix the children of the
    node on which it is called, or all descendants?

Returns **[Branch][70]** The Branch on which it was called.

### getAncestors

Returns an Array of all the ancestors of a given Branch

Returns **[Array][71]** Every Ancestor of the Branch on which it was called.

### getChild

Given an id, returns the child with that id (or undefined if no such child
is present).

#### Parameters

-   `childID` **[String][66]** the id of the child to return.

Returns **([Branch][70] \| [undefined][74])** The desired child branch, or undefined if the
child doesn't exist.

### getDescendant

Given an id string, returns the descendant Branch with that ID, or undefined if it doesn't exist.

#### Parameters

-   `id` **[String][66]** The id string of the Branch to find

Returns **([Branch][70] \| [undefined][74])** The descendant Branch, or undefined if it doesn't exist

### getDescendants

Returns an array of all Branches which are descendants of this Branch

#### Parameters

-   `nonterminus` **falsy?** Is this not the node on which the user called
    the function? This is used internally and should be ignored.

Returns **[Array][71]** An array of all Branches descended from this Branch

### getLeafs

alias of getLeaves

Type: [Function][75]

### getLeaves

Returns an array of all leaves which are descendants of this Branch

Returns **[Array][71]** An array of all leaves descended from this Branch

### getMRCA

Traverses the tree upward until it finds the Most Recent Common Ancestor
(i.e. the first Branch for which both the Branch on which it was called and
`cousin` are descendants).

#### Parameters

-   `cousin`  

Returns **[Branch][70]** The Most Recent Common Ancestor of both the Branch on
which it was called and the `cousin`.

### getRoot

Traverses the tree upward until it finds the root node, and returns the
root.

Returns **[Branch][70]** The root node of the tree

### hasChild

Determines if a given Branch (or ID) is a child of this Branch

#### Parameters

-   `child` **([Branch][70] \| [String][66])** The branch (or the id thereof) to check for

Returns **[Boolean][73]** 

### hasDescendant

Checks to see if `descendant` is a descendant of the Branch on which this
method is called.

#### Parameters

-   `descendant` **([Branch][70] \| [String][66])** Either the descendant Branch or its'
    `id`.

Returns **[Boolean][73]** True if `descendant` is descended from the Branch from
which this is called, otherwise false.

### hasLeaf

Checks to see if a Branch has a descendant leaf.

#### Parameters

-   `leaf`  

Returns **[Boolean][73]** True if leaf is both a leaf and a descendant of the
Branch on which this method is called, False otherwise.

### invert

Swaps a child with its parent. This method is probably only useful as an
internal component of [Branch.reroot][45].

Returns **[Branch][70]** The branch object on which it was called.

### isChildOf

Returns whether the node on which it is called is a child of a given parent
(or parent ID).

#### Parameters

-   `parent` **([Branch][70] \| [String][66])** A Branch (or ID thereof) to test for
    paternity of this node.

Returns **[Boolean][73]** True is `parent` is the parent of this Branch, false
otherwise.

### isConsistent

Tests whether this and each descendant branch holds correct links to both
its parent and its children.

Returns **[Boolean][73]** True if consistent, otherwise false

### isDescendantOf

Returns whether a given Branch is an ancestor of the Branch on which this
method is called. Uses recursive tree-climbing.

#### Parameters

-   `ancestor` **\[type]** [description]

Returns **\[type]** [description]

### isLeaf

Returns a boolean indicating if this Branch is a leaf (i.e. has no
children).

Returns **[Boolean][73]** True is this Branch is a leaf, otherwise false.

### isolate

Returns a boolean indicating whether or not this Branch is olate.

...Just kidding!

Isolates a Branch and its subtree (i.e. removes everything above it, making
it the root Branch). Similar to [Branch.remove][44], only it returns
the Branch on which it is called.

Returns **[Branch][70]** The branch object on which it was called.

### isRoot

Returns a boolean indicating if this Branch is the root of a tree (i.e. has
no parents).

Returns **[Boolean][73]** True if this Branch is the root, otherwise false.

### remove

Removes a Branch and its subtree from the tree. Similar to
[Branch.isolate][42], only it returns the root Branch of the tree
from which this Branch is removed.

Returns **[Branch][70]** The root of the remaining tree.

### reroot

Reroots a tree on this Branch. Use with caution, this returns the new root,
which should typically supplant the existing root branch object, but does
not replace that root automatically.

#### Examples

```javascript
tree = tree.children[0].children[0].reroot();
```

Returns **[Branch][70]** The new root branch, which is either the Branch on which this was called or its parent

### setLength

Set the length of a Branch

#### Parameters

-   `length` **[number][72]** The new length to assign to the Branch

Returns **[Branch][70]** The Branch object on which this was called

### setParent

Sets the parent of the Branch on which it is called.

#### Parameters

-   `parent` **[Branch][70]** The Branch to set as parent

Returns **[Branch][70]** The Branch on which this method was called.

### sources

Determines whether this branch is likelier to be a source of `cousin`, or
if `cousin` is a source of this Branch.

#### Parameters

-   `cousin` **[Branch][70]** The other branch to test

Returns **[Boolean][73]** True if this might be the source of cousin, otherwise
false.

### targets

Determines whether this branch is likelier to be a target of `cousin`, or
if `cousin` is a target of this Branch.

#### Parameters

-   `cousin` **[Branch][70]** The other branch to test

Returns **[Boolean][73]** True if this might be the target of cousin, otherwise
false.

### toJSON

toJSON is an alias for [toObject][76], enabling the safe use of
`JSON.stringify` on Branch objects (in spite of their circular references).

Type: [Function][75]

Returns **[Object][69]** A serializable Object

### toMatrix

Computes a matrix of all patristic distances between all leaves which are
descendants of the Branch on which this method is called.

Returns **[Object][69]** An Object containing a matrix (an Array of Arrays) and
Array of `id`s corresponding to the rows (and columns) of the matrix.

### toNewick

Returns the Newick representation of this Branch and its descendants.

#### Parameters

-   `nonterminus` **[Boolean][73]** Is this not the terminus of the
    Newick Tree? This should be falsy when called by a user (i.e. you). It's
    used internally to decide whether or not in include a semicolon in the
    returned string. (optional, default `falsy`)

Returns **[String][66]** The [Newick][77]
representation of the Branch.

### toObject

Returns a simple Javascript object version of this Branch and its
descendants. This is useful in cases where you want to serialize the tree
(e.g. `JSON.stringify(tree)`) but can't because the tree contains circular
references (for simplicity, elegance, and performance reasons, each branch
tracks both its children and its parent).

Returns **[Object][69]** A serializable bare Javascript Object representing this
branch and its descendants.

## parseJSON

Parses a hierarchical JSON string (or Object) as a Branch object.

### Parameters

-   `json` **([String][66] \| [Object][69])** A json string (or Javascript Object)
    representing hierarchical data.
-   `idLabel` **[String][66]** The key used in the objects of `json` to
    indicate their identifiers. (optional, default `id`)
-   `lengthLabel` **[String][66]** The key used in the objects of `json`
    to indicate their length. (optional, default `length`)
-   `childrenLabel` **[String][66]** The key used in the objects of
    `json` to indicate their children. (optional, default `children`)

Returns **[Branch][70]** The Branch representing the root of the
hierarchy represented by the input JSON

## parseMatrix

Parses a matrix of distances and returns the root Branch of the output tree.
This is adapted from Maciej Korzepa's [neighbor-joining][78],
which is released for modification under the [MIT License][79].

### Parameters

-   `matrix` **[Array][71]** An array of `n` arrays of length `n`
-   `labels` **[Array][71]** An array of `n` strings, each corresponding to the values in matrix

Returns **[Branch][70]** A Branch object representing the root node of the tree inferred by neighbor joining on matrix

## parseNewick

Parses a Newick String and returns a Branch object representing the root
of the output Tree.
This is adapted Jason Davies' [newick.js][80],
which is released for modification under [the MIT License][79].

### Parameters

-   `newick` **[string][66]** A Newick String

Returns **[Branch][70]** A Branch representing the root of the output

[1]: #version

[2]: #examples

[3]: #branch

[4]: #parameters

[5]: #addchild

[6]: #parameters-1

[7]: #addparent

[8]: #parameters-2

[9]: #clone

[10]: #depthof

[11]: #parameters-3

[12]: #distanceto

[13]: #parameters-4

[14]: #excise

[15]: #fixparenthood

[16]: #parameters-5

[17]: #getancestors

[18]: #getchild

[19]: #parameters-6

[20]: #getdescendant

[21]: #parameters-7

[22]: #getdescendants

[23]: #parameters-8

[24]: #getleafs

[25]: #getleaves

[26]: #getmrca

[27]: #parameters-9

[28]: #getroot

[29]: #haschild

[30]: #parameters-10

[31]: #hasdescendant

[32]: #parameters-11

[33]: #hasleaf

[34]: #parameters-12

[35]: #invert

[36]: #ischildof

[37]: #parameters-13

[38]: #isconsistent

[39]: #isdescendantof

[40]: #parameters-14

[41]: #isleaf

[42]: #isolate

[43]: #isroot

[44]: #remove

[45]: #reroot

[46]: #examples-1

[47]: #setlength

[48]: #parameters-15

[49]: #setparent

[50]: #parameters-16

[51]: #sources

[52]: #parameters-17

[53]: #targets

[54]: #parameters-18

[55]: #tojson

[56]: #tomatrix

[57]: #tonewick

[58]: #parameters-19

[59]: #toobject

[60]: #parsejson

[61]: #parameters-20

[62]: #parsematrix

[63]: #parameters-21

[64]: #parsenewick

[65]: #parameters-22

[66]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[67]: #parseNewick

[68]: #parseMatrix

[69]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[70]: #branch

[71]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[72]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[73]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[74]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined

[75]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[76]: #toObject

[77]: https://en.wikipedia.org/wiki/Newick_format

[78]: https://github.com/biosustain/neighbor-joining

[79]: https://opensource.org/licenses/MIT

[80]: https://github.com/jasondavies/newick.js/blob/master/src/newick.js
